#!/bin/bash

#################################################
#           Panda Linux installer               #
#                                               #
# Abhimanyu Saharan <desk.abhimanyu@gmail.com>  #
#################################################

source global
source handleErrors
source getPkgs
source functions
source requirementsCheck
source cleanup
source initSetup
source build

# Accept mount point from the user
# FIXME Add leading slash
MOUNT_POINT="${1}"

# Verify existence of mount point
if [ ! -d $MOUNT_POINT ]
then
    displayMsg ERR "Mount point does not exist."
    exit 1
fi

if [ "${MOUNT_POINT}" == "" ]
then
    displayMsg WARN "Usage: ./install <mointPoint>"
    exit 1
fi

displayMsg OK "------- PANDA LINUX -------"
displayMsg ""

#################################################################
# Copy the data to the mount point                              #
#################################################################

displayMsg OK "Copying data ..."
cp -ur ./* $MOUNT_POINT
displayMsg OK "Done ..."

#################################################################

# Download all the packages before continuing
#getBasicPkgs
# Verify System Requirements
checkReq
# Create necessary directories
createReqDir
# Start installing the basic packages
initSetup
# Cleanup the system
cleanup